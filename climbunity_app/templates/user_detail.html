{% extends 'base.html' %}
{% block content %}

<h1> {{ user.username }}'s Profile</h1>

<h2>Climbing Styles</h2>

{% if user.user_does_styles %}
    <ul>
        {% for style in user.user_does_styles %}
            <li>{{ style }}</li>    
        {% endfor %}
    </ul>
{% endif %}

<h2>Current Projects</h2>

{% if user.user_projects %}
    {% for route in user.user_projects%}
        <div>{{ route.name }} - {{ route.grade }}
            {% if user == current_user %}
                <form style="display: inline;" method="POST" action="/remove_from_project_list/{{ route.id }}">
                    <input style="margin: 0; padding: 0;" type="submit" value="delete"/>
                </form>
            {% endif %}
        </div>
    {% endfor %}
{% else %}
<p>No projects are currently being tracked.</p>
{% endif %}

<h2>Recent Ascents</h2>
{% if ascents %}
    <div>
        {% for ascent in ascents %}
            <p>{{ ascent.send_date }} - <a href="/route/{{ ascent.route_id }}" > {{ ascent.routes_ascended[0].name }}</a></p>
            {% if ascent.send_rating %}
                <p>Rating: {{ ascent.send_rating }}/5</p> 
            {% endif %}
            {% if ascent.send_comments %}
                <p>Comments {{ ascent.send_comments }}</p>
            {% endif %}
            {% if user == current_user %}
            <form method="POST" action="/delete_ascent/{{ ascent.id }}">
                <input type="submit" value="Delete ascent">
            </form>
            {% endif %}
        {% endfor %}
    </div>
{% else %}
    {% if current_user.id == user.id %}
        You haven't logged any ascents yet!
    {% else %}
        {{ user.first_name }} {{ user.last_name }} has not logged any ascents yet!
    {% endif %}  
{% endif %}

{% if user == current_user %}
    <h2>Your Upcoming Appointments</h2>
    {% if user.user_appointments %}
        <div>
            {% for appointment in user.user_appointments %}
                <p>{{ appointment.appointment_datetime }} @ <a href="/venue/{{ appointment.venue_id }}" >{{ appointment.appointment_venues[0] }}</a></p>
                <form method="POST" action="/delete_appointment/{{ appointment.id }}">
                    <input type="submit" value="Delete appointment">
                </form>
            {% endfor %}
        </div>
    {% else %}
        <p>You have no appointments yet!</p>
    {% endif %}
{% else %}
    <h2>{{ user.username }}'s Upcoming Appointments</h2>
    {% if user.user_appointments %}
    <div>
        {% for appointment in user.user_appointments %}
        <p>{{ appointment.appointment_datetime }} @ <a href="/venue/{{ appointment.venue_id }}" >{{ appointment.appointment_venues[0] }}</a> 
            {% if current_user.is_authenticated %}
                <form method="POST" action="/join_appointment/{{ appointment.id }}">
                    <input type="submit" value="Join Appointment!">
                </form></p>
            {% endif %}
        {% endfor %}
    </div>  
    {% endif %}
{% endif %}

{% endblock %}